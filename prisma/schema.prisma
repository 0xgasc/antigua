generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id       String @id @default(cuid())
  email    String @unique
  password String
  role     Role   @default(ADMIN)
  name     String
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Aldea {
  id                      Int      @id @default(autoincrement())
  name                    String
  nameEn                  String?
  slug                    String   @unique
  shortDesc               String
  shortDescEn             String?
  description             String   @db.Text
  descriptionEn           String?  @db.Text
  images                  String[]
  location                Json     // Contains lat, lng, distance, municipality, department, elevation
  highlights              String[]
  highlightsEn            String[]
  population              Int?
  foundedYear             Int?
  status                  AldeaStatus @default(ACTIVE)
  category                AldeaCategory
  mainActivities          String[]
  mainActivitiesEn        String[]
  culturalSignificance    String   @db.Text
  culturalSignificanceEn  String?  @db.Text
  infrastructure          Json     // Contains hasSchool, hasHealthCenter, hasElectricity, hasWater, roadAccess
  languages               String[]
  economicActivities      String[]
  economicActivitiesEn    String[]
  
  tours Tour[]
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Tour {
  id          String @id @default(cuid())
  title       String
  slug        String @unique
  description String
  shortDesc   String
  images      String[]
  price       Float
  duration    Int // in hours
  maxCapacity Int
  difficulty  Difficulty
  category    TourCategory
  highlights  String[]
  included    String[]
  notIncluded String[]
  
  aldeaId Int?
  aldea   Aldea?  @relation(fields: [aldeaId], references: [id])
  
  bookings Booking[]
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Booking {
  id           String        @id @default(cuid())
  tourId       String
  tour         Tour          @relation(fields: [tourId], references: [id])
  
  customerName    String
  customerEmail   String
  customerPhone   String
  participants    Int
  selectedDate    DateTime
  totalPrice      Float
  status          BookingStatus @default(PENDING)
  
  paymentId    String?
  paymentStatus PaymentStatus @default(PENDING)
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Event {
  id          String @id @default(cuid())
  title       String
  slug        String @unique
  description String
  shortDesc   String
  image       String?
  startDate   DateTime
  endDate     DateTime?
  location    String
  category    EventCategory
  isFeatured  Boolean @default(false)
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

enum Role {
  ADMIN
  EDITOR
}

enum Difficulty {
  EASY
  MODERATE
  CHALLENGING
}

enum TourCategory {
  CULTURAL
  ADVENTURE
  NATURE
  HISTORICAL
  GASTRONOMIC
  RELIGIOUS
}

enum EventCategory {
  FESTIVAL
  CULTURAL
  RELIGIOUS
  SEASONAL
}

enum BookingStatus {
  PENDING
  CONFIRMED
  CANCELLED
  COMPLETED
}

enum PaymentStatus {
  PENDING
  COMPLETED
  FAILED
  REFUNDED
}

enum AldeaStatus {
  ACTIVE
  DRAFT
}

enum AldeaCategory {
  CULTURAL
  ARTISAN
  NATURE
  AGRICULTURAL
  HISTORICAL
}